<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs title="Hangout Starter">
<Require feature="rpc"/>
<Require feature="views"/>
<Require feature="locked-domain"/>
</ModulePrefs>
<Content type="html">
<![CDATA[
  <html>
    <style type="text/css"> 
      <!-- 
      .button { 
        border-radius: 3px; 
        -moz-border-radius: 3px; 
        background: -webkit-gradient(linear, left top, left bottom, from(#fff), to(#ddd)); 
        background: -moz-linear-gradient(top, #fff, #ddd); 
        border: 1px solid #bbb; 
      }
      .button:active { 
        background: -webkit-gradient(linear, left top, left bottom, from(#aaa), to(#333)); 
        background: -moz-linear-gradient(bottom, #ddd, #aaa); 
      } 
      --> 
    </style>
    <body>
      <script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script> 
      <canvas id="myCanvas" width="700" height="700" style="border:1px solid #000000;">
        Your browser does not support the HTML5 canvas tag.
      </canvas>
      <button onclick="saveCanvas();"> Save </button>

      <script> 
    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    
    var img = new Image();
    img.onload = function() { ctx.drawImage(img, 50, 50); }
    //img.src = "picture.jpg";
    img.src = "https://lh5.googleusercontent.com/-SBpxcvgGc4g/UfaEW943UUI/AAAAAAAAABo/HsWxOic8AOQ/s0/hangout_snapshot_5.png";

    var img2 = new Image();
    img2.onload = function() { ctx.drawImage(img2, 0, 0); }
    //img2.src = "scream.jpg";
    img2.src = "https://lh6.googleusercontent.com/-M7Eym_cMck4/UfauFZQCLDI/AAAAAAAAAB4/tn25LGttXOI/s0/hangout_snapshot_6.png";
    
    saveCanvas = function() {
      var canvas = document.getElementById("myCanvas");
      var img = canvas.toDataURL("image/jpg");
      //Convert image to 'octet-stream' (Just a download, really)
      img.replace("image/png", "image/octet-stream"); 
      window.location.href = img;      
    }        
        function init() { 
          // When API is ready... 
          gapi.hangout.onApiReady.add( function(eventObj) {
          });
        } 
        // Wait for gadget to load. 
        gadgets.util.registerOnLoadHandler(init);
        
        
      </script>
    </body>
  ]]>
</Content>
</Module>